<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Just Sream It</title>
        <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
        <link rel="stylesheet" href="style/header.css">
        <link rel="stylesheet" href="style/home.css">
        <script src="//code.jquery.com/jquery-1.10.2.js"></script> 
        <script>$(function(){$("#header").load("header.html");
                $("#footer").load("footer.html");}); 
        </script> 
        <script type="text/javascript">
        
          function findTheBestMovie() {
            fetch("http://localhost:8000/api/v1/titles/?sort_by=-imdb_score")
            .then((response) => response.json())
            // .then((data) => console.log(data))
            .then((data) => {
              let bestMovieInfos = document.createElement('div');
              bestMovieInfos.className = "best-movie-infos";
              // bestMovieInfos.id = "best-movie-infos";
              let bestMovieTitle = document.createElement('h2');
              bestMovieTitle.textContent = data["results"][0]["title"];
              let imageUrl = document.createElement('img');
              imageUrl.src = data["results"][0]["image_url"];
              imageUrl.className = "best-movie-image";
              let descriptionUrl = data["results"][0]["url"]
              let bestMovie = document.querySelector('#best-movie');
              let playButton = document.createElement('button');
              playButton.innerHTML = "Play";
              bestMovieInfos.appendChild(bestMovieTitle);
              bestMovieInfos.appendChild(playButton);
              bestMovieInfos.appendChild(imageUrl);
              bestMovie.appendChild(bestMovieInfos);
              return fetch(descriptionUrl)
            })
              // fetch(descriptionUrl)
              .then((response) => response.json())
              // .then((description) => console.log(description["description"]))
              .then((description) => {
              let bestMovieDescription = document.createElement('p')
              bestMovieDescription.textContent = description["description"]
              let bestMovieInfos = document.querySelector(".best-movie-infos")
              bestMovieInfos.appendChild(bestMovieDescription)
              
            })
          }
          function topRatedMovies() {
            for (let y = 1; y < 5; y++){
              url = "http://localhost:8000/api/v1/titles/?page="+y+"&sort_by=-imdb_score"
              console.log(url)
              fetch(url)
              .then((response) => response.json())
              .then((data) => {
                for (let i = 0; i < 8; i++){
                let imageUrl = document.createElement('img');
                imageUrl.src = data["results"][i]["image_url"];
                imageUrl.className = "top-rated-image";
                let bestMovie = document.querySelector('#top-rated')
                bestMovie.appendChild(imageUrl)
                }
              })}
          }
          function topRatedGenre(genre, selectorQuery){
            for (let y = 1; y < 5 ; y++){
              url = "http://localhost:8000/api/v1/titles/?page="+y+"&genre="+genre+"&sort_by=-imdb_score"
              console.log(url)
              fetch(url)
              .then((response) => response.json())
              .then((data) => {
                for (let i = 0; i < 8; i++){
                let imageUrl = document.createElement('img');
                imageUrl.src = data["results"][i]["image_url"];
                imageUrl.className = "top-rated-image";
                let bestMovie = document.querySelector(selectorQuery)
                bestMovie.appendChild(imageUrl)
                }
              })}
          };
          function scrollToLeft(idTag) {
            let leftButton = document.getElementById(idTag);
            leftButton.scrollLeft -= 200;
          };
          function scrollToRight() {
            let rightButton = document.getElementById(idTag);
            rightButton.scrollLeft += 200;
          };
          findTheBestMovie()
          topRatedMovies()
          topRatedGenre("action", "#top-rated-action")
          topRatedGenre("comedy", "#top-rated-comedy")
          topRatedGenre("thriller", "#top-rated-thriller")
        </script>
    </head>
    <body>
        <div id="header"></div> 
        <div class="main">
            <div id="best-movie">
            </div>
            <div class="images-carousel">
              <h2>Les mieux notés</h2>
              <div id="top-rated-container">
                <div id="top-rated">
                  <img onclick="scrollToLeft(idTag='top-rated-container')" class="arrow-left" id="left-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                  <img onclick="scrollToRight(idTag='top-rated-container')" class="arrow-right" id="right-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                </div>
              </div>
            <div class="images-carousel">
                <h2>Action</h2>
                <div id="top-rated-action-container">
                  <div id="top-rated-action">
                    <img onclick="scrollToLeft(idTag='top-rated-action-container')" class="arrow-left" id="left-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                    <img onclick="scrollToRight(idTag='top-rated-action-container')" class="arrow-right" id="right-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                  </div>
                </div>
            </div>
            <div class="images-carousel">
                <h2>Comédie</h2>
                <div id="top-rated-comedy-container">
                  <div id="top-rated-comedy">
                    <img onclick="scrollToLeft(idTag='top-rated-comedy-container')" class="arrow-left" id="left-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                    <img onclick="scrollToRight(idTag='top-rated-comedy-container')" class="arrow-right" id="right-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                  </div>
                </div>
            </div>
            <div class="images-carousel">
                <h2>Thriller</h2>
                <div id="top-rated-thriller-container">
                  <div id="top-rated-thriller">
                    <img onclick="scrollToLeft(idTag='top-rated-thriller-container')" class="arrow-left" id="left-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                    <img onclick="scrollToRight(idTag='top-rated-thriller-container')" class="arrow-right" id="right-button" src="/images/fleche-droite.png" alt="flèche de défilement">
                  </div>
                </div>
            </div>
        </div>
        <footer>
            <div class="block-footer">
              <div class="col1">
                <h3 class="heading">
                  Informations
                </h3>
                <ul>
                  <li>
                    <a href="#">
                      Devenir client
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      A propos
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      FAQ
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      Contact
                    </a>
                  </li>
                </ul>
              </div>
          
              <div class="col2">
                <h3 class="heading">
                  Language
                </h3>
                <div class="languages">
                  <a href="#">Deutsch</a>
                  <a href="#">English</a>
                  <a href="#">Espaṅol</a>
                  <a href="#">Français</a>
                  <a href="#">Indonesian</a>
                  <a href="#">Italian</a>
                  <a href="#">Nederlands</a>
                  <a href="#">Polnisch</a>
                  <a href="#">Português</a>
                  <a href="#">pyccknṅ</a>
                  <a href="#">Tiéng Viêt</a>
                  <a href="#">Türkçe</a>
                </div>
              </div>
          
              <div class="col3">
                <h3 class="heading">
                  Restons en contact
                </h3>
                <div class="social">
                  <a href="#">
                    <ion-icon name="logo-facebook"></ion-icon>
                  </a>
                  <a href="#">
                    <ion-icon name="logo-twitter"></ion-icon>
                  </a>
                  <a href="#">
                    <ion-icon name="logo-linkedin"></ion-icon>
                  </a>
                </div>
              </div>
            </div>
          
            <p class="terms">
              <a href="#">Conditions de vente</a>
              <a href="#">Politique de confidentialité</a>
              <a href="#">Newsletter</a>
            </p>
          </footer>
          
          <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
          <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    </body>
</html>